<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>My Mac‚ÄëStyle Web Desktop</title>
  <!-- JS‚ÄëDOS for running Doom in the browser -->
  <script src="https://js-dos.com/6.22.1/js-dos.js"></script>
  <style>
    /* Reset & base */
    * { margin: 0; padding: 0; box-sizing: border-box; }
    html, body {
      width: 100%;
      height: 100%;
      overflow: hidden;
      font-family: -apple-system, BlinkMacSystemFont, sans-serif;
      /* Penguin wallpaper */
      background-image: url('https://upload.wikimedia.org/wikipedia/commons/7/71/Emperor_Penguin_Manchot_empereur.jpg');
      background-repeat: no-repeat;
      background-position: center center;
      background-size: cover;
    }

    /* Top menu bar */
    #menubar {
      position: absolute;
      top: 0; left: 0; right: 0;
      height: 22px;
      background: rgba(255,255,255,0.8);
      backdrop-filter: blur(10px);
      display: flex;
      align-items: center;
      padding: 0 8px;
      font-size: 12px;
      color: #000;
      z-index: 100;
    }
    #menubar .menu-item { margin-right: 16px; cursor: default; }

    /* Dock */
    #dock {
      position: absolute;
      bottom: 0;
      left: 50%;
      transform: translateX(-50%);
      height: 48px;
      padding: 4px 8px;
      background: rgba(255,255,255,0.8);
      backdrop-filter: blur(10px);
      border-radius: 12px;
      display: flex;
      align-items: center;
      z-index: 100;
    }
    .dock-icon {
      width: 32px;
      height: 32px;
      margin: 0 6px;
      font-size: 28px;
      line-height: 32px;
      text-align: center;
      cursor: pointer;
    }

    /* App windows */
    .window {
      position: absolute;
      width: 400px;
      height: 300px;
      background: #fff;
      border: 1px solid #ccc;
      border-radius: 6px;
      box-shadow: 0 4px 16px rgba(0,0,0,0.2);
      display: flex;
      flex-direction: column;
      overflow: hidden;
      z-index: 200;
    }
    .window[data-max="1"] {
      top: 22px !important;
      left: 0 !important;
      width: 100% !important;
      height: calc(100% - 70px) !important;
    }
    .window-header {
      height: 24px;
      background: #f0f0f0;
      display: flex;
      align-items: center;
      padding: 0 8px;
      font-size: 12px;
      cursor: move;
    }
    .buttons {
      display: flex;
      gap: 6px;
      margin-right: 8px;
    }
    .buttons div {
      width: 12px;
      height: 12px;
      border-radius: 50%;
      background: red;
      cursor: pointer;
    }
    .buttons div:nth-child(2) { background: #ffbf00; }
    .buttons div:nth-child(3) { background: #28c940; }
    .window-title { flex: 1; text-align: center; }
    .window-content { flex: 1; background: #fff; position: relative; }
    .dos-container { width: 100%; height: 100%; }
  </style>
</head>
<body>
  <!-- Menu bar -->
  <div id="menubar">
    <div class="menu-item">Ô£ø MyWebOS</div>
    <div class="menu-item">File</div>
    <div class="menu-item">Edit</div>
    <div class="menu-item">View</div>
  </div>

  <!-- Dock -->
  <div id="dock">
    <div class="dock-icon" onclick="openWindow('Finder','<h2>Finder</h2><p>Your files go here.</p>')">üìÅ</div>
    <div class="dock-icon" onclick="openWindow('Browser','<h2>Safari</h2><p>Yet to be implemented.</p>')">üåê</div>
    <div class="dock-icon" onclick="openDoom()">üî´</div>
  </div>

  <script>
    let zIndex = 200, windowCount = 0;

    function openWindow(title, contentHtml) {
      windowCount++;
      const win = document.createElement('div');
      win.className = 'window';
      win.style.top = `${50 + windowCount * 20}px`;
      win.style.left = `${50 + windowCount * 20}px`;
      win.style.zIndex = zIndex++;
      win.dataset.max = '0';
      win.innerHTML = `
        <div class="window-header" onmousedown="startDrag(event, this.parentElement)">
          <div class="buttons"><div></div><div></div><div></div></div>
          <div class="window-title">${title}</div>
        </div>
        <div class="window-content">${contentHtml}</div>
      `;
      document.body.appendChild(win);

      const btns = win.querySelectorAll('.buttons div');
      btns[0].onclick = () => win.remove();
      btns[1].onclick = () => win.style.display = 'none';
      btns[2].onclick = () => toggleMax(win);
    }

    function toggleMax(win) {
      win.dataset.max = win.dataset.max === '1' ? '0' : '1';
    }

    function openDoom() {
      windowCount++;
      const id = `dos-${windowCount}`;
      const win = document.createElement('div');
      win.className = 'window';
      win.style.top = `${50 + windowCount * 20}px`;
      win.style.left = `${50 + windowCount * 20}px`;
      win.style.zIndex = zIndex++;
      win.dataset.max = '0';
      win.innerHTML = `
        <div class="window-header" onmousedown="startDrag(event, this.parentElement)">
          <div class="buttons"><div></div><div></div><div></div></div>
          <div class="window-title">Doom</div>
        </div>
        <div class="window-content">
          <div class="dos-container" id="${id}"></div>
        </div>`;
      document.body.appendChild(win);

      const btns = win.querySelectorAll('.buttons div');
      btns[0].onclick = () => win.remove();
      btns[1].onclick = () => win.style.display = 'none';
      btns[2].onclick = () => toggleMax(win);

      Dos(document.getElementById(id), { wdosboxUrl: 'https://js-dos.com/6.22.1/wdosbox.js' })
        .then(dos => dos.run('https://js-dos.com/cdn/6.22.1/games/doom/doom1.wad'));
    }

    let offsetX, offsetY, draggedWin;
    function startDrag(e, win) {
      draggedWin = win;
      offsetX = e.clientX - win.offsetLeft;
      offsetY = e.clientY - win.offsetTop;
      document.addEventListener('mousemove', drag);
      document.addEventListener('mouseup', stopDrag);
    }
    function drag(e) {
      if (draggedWin) {
        draggedWin.style.left = `${e.clientX - offsetX}px`;
        draggedWin.style.top = `${e.clientY - offsetY}px`;
        draggedWin.style.zIndex = zIndex++;
      }
    }
    function stopDrag() {
      document.removeEventListener('mousemove', drag);
      document.removeEventListener('mouseup', stopDrag);
      draggedWin = null;
    }
  </script>
</body>
</html>
